@inject IFileReaderService FileReaderService

<input accept="@FileFormats" id="@_filePickerGuid" multiple="@AllowMultiple" @onchange="@ReadFile" @ref="@_element"
       style="display: none"
       type="file"/>

<input value="@Title" type="button" onclick="document.getElementById('@_filePickerGuid').click()" />

@code {
    [Parameter]
    public EventCallback<IEnumerable<IFileReference>> OnFilesSelected { get; set; }

    [Parameter]
    public string Title { get; set; }

    [Parameter]
    public bool AllowMultiple { get; set; } = false;

    [Parameter]
    public string FileFormats { get; set; } = "";

    private ElementReference _element;
    private readonly Guid _filePickerGuid = Guid.NewGuid();

    private async Task ReadFile()
    {
        var reader = FileReaderService.CreateReference(_element);
        var files = await reader.EnumerateFilesAsync();
        await OnFilesSelected.InvokeAsync(files);
        await reader.ClearValue();
    }
}
